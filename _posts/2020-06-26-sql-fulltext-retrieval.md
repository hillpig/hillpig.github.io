---
layout: post
title: SQL - Full Text Retrieval
date: 2020-06-20
Author: 山猪
tags: [Database, SQL]
comments: true
---
![img](https://intellipaat.com/mediaFiles/2015/11/SQL-e1559106221282.png)

<!-- more -->

## SSO

SSO 是英文 Single Sign On 的缩写，翻译过来就是单点登录。顾名思义，它把两个及以上个产品中的用户登录逻辑抽离出来，达到只输入一次用户名密码，就能同时登录多个产品的效果。

打个比方，SSO 和我们去迪士尼玩时购买的通票很像。

![WX20200629-170628.png](https://i.loli.net/2020/06/30/hL8N5oqJHdQvOkz.png)

我们只要买一次通票，就可以玩所有游乐场内的设施，而不需要在过山车或者摩天轮那里重新买一次票。在这里，买票就相当于登录认证，游乐场就相当于使用一套 SSO 的公司，各种游乐设施就相当于公司的各个产品。

![WX20200629-170713.png](https://i.loli.net/2020/06/30/xcjFe8YkBGLdQy2.png)

使用 SSO 的优点很明显：

- 提升用户体验。
就以我厂为例。我厂有两个产品，丁香人才网和丁香园论坛，假如你是我厂用户，肯定无法忍受登录丁香园论坛的时候输入一次用户名密码，登录人才网又要输入一次用户名密码吧？
- 避免重复开发
假如你是我厂后端，每天任务都饱和的不行，肯定无法忍受到人才网开发一套登录逻辑，到论坛又开发一套登录逻辑吧？
- 提升安全系数
假如你是我厂运维，发现了一个安全隐患需要紧急修复。你肯定无法忍受给茫茫多的产品后端都发一封邮件，责令修复吧？万一漏了一个呢？

综合看来，SSO 不仅是有用的，而且是必要的。


## CAS
SSO 仅仅是一种架构，一种设计，而 CAS 则是实现 SSO 的一种手段。两者是抽象与具体的关系。当然，除了 CAS 之外，实现 SSO 还有其他手段，比如简单的 cookie。CAS （Central Authentication Service）中心授权服务，本身是一个开源协议，分为 1.0 版本和 2.0 版本。1.0 称为基础模式，2.0称为代理模式，适用于存在非 Web 应用之间的单点登录。本文只涉及 CAS 1.0，下文中将详细介绍。

## SSO 的演进与分类

下面详述一下各种场景下的 SSO，它们之间是逐步升级，逐步复杂化的关系。

1. 同域 SSO如图，同域 SSO 是最简单的一种情况。此时，两个产品都是在一个域名下，单点登录是很自然的选择。我们来捋一捋步骤，搞清楚这里的步骤是理解后文的基础，千万不要跳过。

    1. 用户访问产品 a，向 后台服务器发送登录请求。
    2. 登录认证成功，服务器把用户的登录信息写入 session。
    3. 服务器为该用户生成一个 cookie，并加入到 response header 中，随着请求返回而写入浏览器。该 cookie 的域设定为 dxy.cn。
    4. 下一次，当用户访问同域名的产品 b 时，由于 a 和 b 在同一域名下，也是 dxy.cn，浏览器会自动带上之前的 cookie。此时后台服务器就可以通过该 cookie 来验证登录状态了。

实际上，这种场景就是最简单最传统的登录操作。虽然我们把产品 a 和 b 人为分开了，但由于它们在同域上，就算看成是同一产品的不同类目也未尝不可。我们没有设置独立的 SSO 服务器，因为业务后台服务器本身就足以承担 SSO 的职能。



[参考原文1](https://www.jianshu.com/p/4b1a88d1c1d0)

[参考原文2](https://towardsdatascience.com/a-guide-to-unicode-utf-8-and-strings-in-python-757a232db95c)

[参考原文3](https://www.iteye.com/blog/mikzhang-1101705)
